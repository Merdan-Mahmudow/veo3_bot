
# Veo3 Бот
Veo3 Бот — это полноценная платформа для генерации коротких видеороликов через API Veo 3.
Проект включает асинхронный backend на FastAPI и телеграм‑бот на aiogram. Пользователь
взаимодействует с ботом, чтобы описать или отправить фото желаемого видео; бот помогает
уточнить запрос при помощи ChatGPT, отправляет запрос на генерацию в KIE (Veo 3), сохраняет
результат в Yandex Cloud Storage и уведомляет пользователя о готовности. Для каждой генерации
списывается «монета»; монеты можно купить через платежи Telegram, а пользователь может
оценить полученный результат.
# Возможности
 - Backend на FastAPI для управления пользователями, задачами и монетами, обработки webhook‑колбеков и рассылок.
 - Асинхронный доступ к PostgreSQL через SQLAlchemy, миграции Alembic создают таблицы users и tasks .
Сервис генерации промптов на основе OpenAI ChatGPT, который создаёт
структурированные промпты на русском и английском языках.
Интеграция с API KIE (Veo 3) для генерации видео по тексту или фото.
Redis‑кэш для хранения метаданных задач и системных промптов.
Хранилище Yandex Cloud для загрузки готовых видео и формирования публичных
ссылок.
Телеграм‑бот, который ведёт пользователя по процессу генерации, отображает прогресс,
обрабатывает платежи и принимает оценки.
Эндпоинт рассылки для отправки сообщений, фото или видео всем зарегистрированным
пользователям.
Быстрый старт
Требования
Python 3.10+ (проверено на Python 3.11).
PostgreSQL база данных.
Redis для кеширования.
Аккаунт Yandex Cloud и доступы к S3 для хранения файлов.
Токен Telegram‑бота и тестовый токен провайдера платежей.
API‑токен KIE (Veo 3) для генерации видео.
Переменные окружения
Скопируйте env.example в .env и заполните собственными значениями. Важные
переменные (здесь приведены примеры):
# Сервисы
KIE_TOKEN=...
OPENAI_API_KEY=sk-... # токен OpenAI
OPENAI_MODEL=gpt-5-nano # модель ChatGPT
# Яндекс Облако
YC_FOLDER_ID=...
YC_API_KEY=...
YC_S3_ACCESS_KEY_ID=...
YC_S3_SECRET_ACCESS_KEY=...
YC_S3_ENDPOINT_URL=https://storage.yandexcloud.net
# Telegram
BOT_TOKEN=1234567890:Abc... # токен бота
WEBHOOK_ENDPOINT=https://your.domain/bot
BOT_API_TOKEN=... # ключ API для запросов от бота на backend
TEST_PAYMENT_TOKEN=12345:TEST:... # токен провайдера платежей
# База данных
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_NAME=veo3
POSTGRES_USER=veo3
POSTGRES_PASS=secret
BASE_URL=http://localhost # внешний адрес backend’а
CALLBACK_PATH=/bot/veo/callback # путь для callback KIE
SUPPORT_USERNAME=your_username # username для обратной связи
# Redis
REDIS_URL=redis://localhost:6379
Эти переменные загружаются через Pydantic в config.py и используются для сборки строки
подключения к PostgreSQL и других настроек.
Установка
Клонируйте репозиторий и перейдите в его директорию:
git clone https://github.com/Merdan-Mahmudow/veo3_bot.git
cd veo3_bot
Создайте виртуальное окружение и установите зависимости (проект использует Poetry,
можно установить через pip ):
python3 -m venv venv
source venv/bin/activate
pip install --upgrade pip
pip install -r requirements.txt
# либо: poetry install
Скопируйте env.example в .env и заполните его.
1.
1.
1.
2
Выполните миграции базы данных:
alembic upgrade head
Запуск backend
Запустите FastAPI‑приложение через uvicorn. Оно публикует REST‑эндпоинты для управления
пользователями, задачами, промптами и генерацией, а также принимает callback’и от KIE:
uvicorn api.main:app --host 0.0.0.0 --port 8000
Backend регистрирует веб‑хук у Telegram, поэтому убедитесь, что ваш публичный BASE_URL
доступен для Telegram и KIE.
Запуск бота
Бот определён в bot/bot/__init__.py . Чтобы запустить его, выполните:
python -m bot.bot
При старте бот регистрирует свой webhook, подключает роутеры для основной логики и
платежей и начинает обработку входящих обновлений.
Использование Docker
Для развёртывания можно собрать два контейнера (backend и бот) в одной сети и использовать
общий файл .env . Backend должен быть доступен по публичному URL для Telegram и KIE, а бот
может работать в приватной сети, но ему нужен доступ к Telegram и backend.
Структура проекта
veo3_bot/
├── api/ # FastAPI‑приложение (роуты, модели, сервисы,
безопасность)
├── bot/ # Телеграм‑бот (менеджер, api‑клиент, FSM‑состояния,
роутеры)
├── services/ # Интеграции (gpt, kie, storage, redis, notifier,
veo)
├── utils/ # Утилиты (например, индикация прогресса)
├── alembic/ # Миграции БД
├── config.py # Настройки Pydantic и сборка URL БД
├── env.example # Пример переменных окружения
├── pyproject.toml # Конфигурация Python‑проекта
└── README.md # Этот файл на английском
2.
Вклад и лицензия
Пожелания, баг‑репорты и предложения приветствуются — создавайте issue или отправляйте
pull‑request. Проект распространяется без указания лицензии; для получения информации о
лицензировании обратитесь к владельцу репозитория.
